<!doctype html><html><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><link rel=icon href=/fav.png type=image/png><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Alata&family=Lora&family=Muli:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto&family=Muli:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Alata&family=Lora&family=Muli:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto&family=Muli:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" media=print onload='this.media="all"'><noscript><link href="https://fonts.googleapis.com/css2?family=Alata&family=Lora&family=Muli:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto&family=Muli:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel=stylesheet></noscript><link rel=stylesheet href=/css/font.css media=all><meta property="og:title" content="Setting the font for an Entry control using Xamarin.Forms"><meta property="og:description" content="Xamarin.Forms depsite being very cool is stil a bit lacking when it comes to not only a good range of controls, but also to the abilities of those controls. One example of this is the Entry control - a simple text box. One thing you can&rsquo;t do with the out of the box implementation is to set the Font. Such a normal thing to do, but not supported.
Luckily, it&rsquo;s reasonably easy to roll your own controls."><meta property="og:type" content="article"><meta property="og:url" content="https://jimbobbennett.dev/blogs/setting-the-font-for-an-entry-control-using-xamarin-forms-2/"><meta property="og:image" content="https://jimbobbennett.dev/blogs/setting-the-font-for-an-entry-control-using-xamarin-forms-2/banner.png"><meta property="article:section" content="blogs"><meta property="article:published_time" content="2014-08-27T05:02:19+00:00"><meta property="article:modified_time" content="2014-08-27T05:02:19+00:00"><meta property="og:site_name" content="JimBobBennett"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://jimbobbennett.dev/blogs/setting-the-font-for-an-entry-control-using-xamarin-forms-2/banner.png"><meta name=twitter:title content="Setting the font for an Entry control using Xamarin.Forms"><meta name=twitter:description content="Xamarin.Forms depsite being very cool is stil a bit lacking when it comes to not only a good range of controls, but also to the abilities of those controls. One example of this is the Entry control - a simple text box. One thing you can&rsquo;t do with the out of the box implementation is to set the Font. Such a normal thing to do, but not supported.
Luckily, it&rsquo;s reasonably easy to roll your own controls."><meta name=twitter:site content="@jimbobbennett"><meta name=twitter:creator content="@jimbobbennett"><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css integrity=sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3 crossorigin=anonymous><link rel=stylesheet href=/css/header.css media=all><link rel=stylesheet href=/css/footer.css media=all><link rel=stylesheet href=/css/theme.css media=all><link rel="shortcut icon" type=image/png href=/fav.png><link rel="shortcut icon" sizes=192x192 href=/fav.png><link rel=apple-touch-icon href=/fav.png><link rel=alternate type=application/rss+xml href=https://jimbobbennett.dev/index.xml title=JimBobBennett><script type=text/javascript>(function(e,t,n,s,o,i,a){e[n]=e[n]||function(){(e[n].q=e[n].q||[]).push(arguments)},i=t.createElement(s),i.async=1,i.src="https://www.clarity.ms/tag/"+o,a=t.getElementsByTagName(s)[0],a.parentNode.insertBefore(i,a)})(window,document,"clarity","script","dctc2ydykv")</script><script data-goatcounter=https://jimbobbennett.goatcounter.com/count async src=//gc.zgo.at/count.js></script><style>:root{--text-color:#343a40;--text-secondary-color:#6c757d;--background-color:#000;--secondary-background-color:#64ffda1a;--primary-color:#007bff;--secondary-color:#f8f9fa;--text-color-dark:#e4e6eb;--text-secondary-color-dark:#b0b3b8;--background-color-dark:#000000;--secondary-background-color-dark:#212529;--primary-color-dark:#ffffff;--secondary-color-dark:#212529}body{background-color:#000;font-size:1rem;font-weight:400;line-height:1.5;text-align:left}</style><meta name=description content><link rel=stylesheet href=/css/index.css><link rel=stylesheet href=/css/single.css><link rel=stylesheet href=/css/projects.css media=all><script defer src=/fontawesome-5/all-5.15.4.js></script><title>Setting the font for an Entry control using Xamarin.Forms | JimBobBennett</title></head><body class=light onload=loading()><header><nav class="pt-3 navbar navbar-expand-lg"><div class="container-fluid mx-xs-2 mx-sm-5 mx-md-5 mx-lg-5"><a class="navbar-brand primary-font text-wrap" href=/><img src=/fav.png width=30 height=30 class="d-inline-block align-top">
JimBobBennett
</a><button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarContent aria-controls=navbarContent aria-expanded=false aria-label="Toggle navigation"><svg aria-hidden="true" height="24" viewBox="0 0 16 16" width="24" data-view-component="true"><path fill-rule="evenodd" d="M1 2.75A.75.75.0 011.75 2h12.5a.75.75.0 110 1.5H1.75A.75.75.0 011 2.75zm0 5A.75.75.0 011.75 7h12.5a.75.75.0 110 1.5H1.75A.75.75.0 011 7.75zM1.75 12a.75.75.0 100 1.5h12.5a.75.75.0 100-1.5H1.75z"/></svg></button><div class="collapse navbar-collapse text-wrap primary-font" id=navbarContent><ul class="navbar-nav ms-auto text-center"><li class="nav-item navbar-text"><a class=nav-link href=/ aria-label=home>Home</a></li><li class="nav-item navbar-text"><a class=nav-link href=/#about aria-label=about>About</a></li><li class="nav-item navbar-text"><a class=nav-link href=/#projects aria-label=projects>Recent Highlights</a></li><li class="nav-item navbar-text"><a class=nav-link href=/blogs title="Blog posts">Blog</a></li><li class="nav-item navbar-text"><a class=nav-link href=/videos title=Videos>Videos</a></li><li class="nav-item navbar-text"><a class=nav-link href=/livestreams title=Livestreams>Livestreams</a></li><li class="nav-item navbar-text"><a class=nav-link href=/conferences title=Conferences>Conferences</a></li><li class="nav-item navbar-text"><a class=nav-link href=/resume title=Resume>Resume</a></li></ul></div></div></nav></header><div id=content><section id=projects><div class="container pt-5" id=list-page><div class="row justify-content-center px-3 px-md-5"><h1 class="text-left pb-2 content">Setting the font for an Entry control using Xamarin.Forms</h1><div class="text-left content"><a href=https://linkedin.com/in/jimbobbennett>Jim Bennett
</a><small>|</small>
Aug 27, 2014</div></div></div></section><section id=single><div class=container><div class="row justify-content-center"><div class="col-sm-12 col-md-12 col-lg-9"><div class=pr-lg-4><article class="page-content p-2"><p><a href=http://xamarin.com/forms>Xamarin.Forms</a> depsite being very cool is stil a bit lacking when it comes to not only a good range of controls, but also to the abilities of those controls.
One example of this is the Entry control - a simple text box. One thing you can&rsquo;t do with the out of the box implementation is to set the Font. Such a normal thing to do, but not supported.</p><p>Luckily, it&rsquo;s reasonably easy to roll your own controls.
Due to the platform independent nature of Xamarin.Forms, to create a control you have to actually create 2 pieces - a portable control, then platform specific renderers to draw the control on each device. I don&rsquo;t have an android subscription, and can&rsquo;t be bothered with WinPhone at the moment, so will only be showing how to do this for iOS.</p><p>First, we need the control inside a portable project. These can be derived from an existing control - here we derive from Entry as we want to extend its functionality.</p><pre tabindex=0><code>public class ExtendedEntry : Entry
{
}
</code></pre><p>Then we add the bindable properties. These are Xamarins version of dependency properties - they have a static field declaring the property then an instance property to get/set the value.</p><pre tabindex=0><code>public class ExtendedEntry : Entry
{
	public static readonly BindableProperty FontProperty =
            BindableProperty.Create(&#34;Font&#34;, typeof(Font), 	
            typeof(ExtendedEntry), new Font());
            
    public Font Font
    {
        get { return (Font)GetValue(FontProperty); }
        set { SetValue(FontProperty, value); }
    }
}
</code></pre><p>This is all we need for our control. Next up is the renderer. This wraps platform specific controls to provide the necessary functionality.
In the case of the Entry control on iOS, the UITextField control is wrapped. To set our font we need to pass the value from the control to the UITextField in the renderer.</p><p>First we create our renderer deriving from the existing entry renderer:</p><pre tabindex=0><code>public class ExtendedEntryRenderer : EntryRenderer
{
}
</code></pre><p>The we override a few methods - <code>OnElementChanged</code> to handle the creation of the control and <code>OnElementPropertyChanged</code> to handle any updates to the properties on the control. In these methods we need to set the font on the UITextView. The Control property of the renderer refers to the underlying UITExtField, the Element property is the ExtendedEntry control.</p><pre tabindex=0><code>public class ExtendedEntryRenderer : EntryRenderer
{
    protected override void OnElementChanged(ElementChangedEventArgs&lt;Entry&gt; e)
    {
        base.OnElementChanged(e);
        var view = (Labs.Controls.ExtendedEntry)Element;
        SetFont(view);
    }

    protected override void OnElementPropertyChanged(object sender, PropertyChangedEventArgs e)
    {
        base.OnElementPropertyChanged(sender, e);

        var view = (Labs.Controls.ExtendedEntry)Element;

        if (string.IsNullOrEmpty(e.PropertyName) || 
            e.PropertyName == &#34;Font&#34;)
            SetFont(view);
    }

    private void SetFont(Labs.Controls.ExtendedEntry view)
    {
        UIFont uiFont;
        if (view.Font != Font.Default &amp;&amp; 
            (uiFont = view.Font.ToUIFont()) != null)
            Control.Font = uiFont;
        else if (view.Font == Font.Default)
            Control.Font = UIFont.SystemFontOfSize(17f);
    }
}
</code></pre><p>As you can we, the Xamarin.Forms Font class provides a nice converter to UIFont to make our life easier, and if the font is not supported we resort to a default system font and size. For the property change we just update the font if the property that changes is the font, or if a property change is raised for an empty string - this saves updating when not required and the empty string check is because raising with an empty string as the property name is the way to say all properties have been updated.</p><p>If we keep it like this, then the font is changed, but there is a bug - the height of the control doesn&rsquo;t change to match the height of the font, we make the font larger and the top/bottom of the text is missing. The final step is to set the height. Luckily UITextField will work out the required height based on the font that is set, so we can create a dummy UITextField, set it&rsquo;s font, get the required height and apply it to both our control and the UITextField hosted in it:</p><pre tabindex=0><code>private void ResizeHeight()
{
    if (Element.HeightRequest &gt;= 0) return;

    var height = Math.Max(Bounds.Height,
        new UITextField 
        {
            Font = Control.Font
        }.IntrinsicContentSize.Height);

    Control.Frame = new RectangleF(0.0f, 
                                   0.0f, 
                                   (float) Element.Width, 
                                   height);

    Element.HeightRequest = height;
}
</code></pre><p>This method uses the HeightRequest property of the Entry control to request a large/smaller height as necessary. This causes the layout to adjust the size to fit if possible. If the HeightRequest is already set (it is -1 if not set), then we do nothing as the user has already decided on what height is needed. All we need to do is just call this after setting the font and everything now works.</p><p>The full source for EnhancedEntry including other properties is available as part of <a href=https://github.com/jimbobbennett/JimLib.Xamarin>JimLIb.Xamarin</a>. I&rsquo;ve also raised a PR to add this to <a href=https://github.com/XForms/Xamarin-Forms-Labs>Xamarin.Forms.Labs</a>.</p></article></div></div><div class="col-sm-12 col-md-12 col-lg-3"><div class=sticky-sidebar><aside class=toc><h5>Table Of Contents</h5><div class=toc-content><nav id=TableOfContents></nav></div></aside><aside class=tags><h5>Tags</h5><ul class="tags-ul list-unstyled list-inline"><li class=list-inline-item><a href=https://jimbobbennett.dev/tags/technology target=_blank>Technology</a></li><li class=list-inline-item><a href=https://jimbobbennett.dev/tags/jimlib.xamarin target=_blank>jimlib.xamarin</a></li><li class=list-inline-item><a href=https://jimbobbennett.dev/tags/xamarin target=_blank>xamarin</a></li><li class=list-inline-item><a href=https://jimbobbennett.dev/tags/xamarin.ios target=_blank>xamarin.ios</a></li><li class=list-inline-item><a href=https://jimbobbennett.dev/tags/technology target=_blank>technology</a></li><li class=list-inline-item><a href=https://jimbobbennett.dev/tags/xamarin.forms target=_blank>xamarin.forms</a></li><li class=list-inline-item><a href=https://jimbobbennett.dev/tags/extendedentry target=_blank>extendedentry</a></li><li class=list-inline-item><a href=https://jimbobbennett.dev/tags/renderer target=_blank>renderer</a></li><li class=list-inline-item><a href=https://jimbobbennett.dev/tags/control target=_blank>control</a></li><li class=list-inline-item><a href=https://jimbobbennett.dev/tags/xamarin.forms.labs target=_blank>xamarin.forms.labs</a></li></ul></aside></div></div></div><div class=row><div class="col-sm-12 col-md-12 col-lg-9 p-4"><div id=disqus_thread></div><script>var disqus_config=function(){this.page.url="https://jimbobbennett.dev/blogs/setting-the-font-for-an-entry-control-using-xamarin-forms-2/",this.page.identifier="b57123e6610127a249b2ef343ba5a15c"};(function(){if(window.location.hostname=="localhost")return;var e=document,t=e.createElement("script");t.src="https://jimbobbennett.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div></div></div><button class="p-2 px-3" onclick=topFunction() id=topScroll>
<i class="fas fa-angle-up"></i></button></section><script>var topScroll=document.getElementById("topScroll");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?topScroll.style.display="block":topScroll.style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}</script></div><footer><div class="container py-4"><div class="row justify-content-center"><div class="col-md-4 text-center">&copy; 2024 All Rights Reserved</div></div></div></div></footer><script src=https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js integrity=sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13 crossorigin=anonymous></script><script>document.body.className.includes("light")&&(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))</script><script>let loadingIcons;function loading(){myVar=setTimeout(showPage,100)}function showPage(){try{document.getElementById("loading-icons").style.display="block"}catch{}}</script><script>function createCopyButton(e,t){const n=document.createElement("button");n.className="copy-code-button",n.type="button",n.innerText="Copy",n.addEventListener("click",()=>copyCodeToClipboard(n,e,t)),addCopyButtonToDom(n,e)}async function copyCodeToClipboard(e,t,n){const s=t.querySelector("pre > code").innerText;try{n.writeText(s)}finally{codeWasCopied(e)}}function codeWasCopied(e){e.blur(),e.innerText="Copied!",setTimeout(function(){e.innerText="Copy"},2e3)}function addCopyButtonToDom(e,t){t.insertBefore(e,t.firstChild);const n=document.createElement("div");n.className="highlight-wrapper",t.parentNode.insertBefore(n,t),n.appendChild(t)}if(navigator&&navigator.clipboard)document.querySelectorAll(".highlight").forEach(e=>createCopyButton(e,navigator.clipboard));else{var script=document.createElement("script");script.src="https://cdnjs.cloudflare.com/ajax/libs/clipboard-polyfill/2.7.0/clipboard-polyfill.promise.js",script.integrity="sha256-waClS2re9NUbXRsryKoof+F9qc1gjjIhc2eT7ZbIv94=",script.crossOrigin="anonymous",script.onload=function(){addCopyButtons(clipboard)},document.querySelectorAll(".highlight").forEach(e=>createCopyButton(e,script)),document.body.appendChild(script)}</script></body></html>