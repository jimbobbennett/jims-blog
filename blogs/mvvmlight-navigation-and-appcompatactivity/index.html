<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=icon href=/fav.png type=image/png><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Alata&family=Lora&family=Muli:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto&family=Muli:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Alata&family=Lora&family=Muli:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto&family=Muli:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" media=print onload='this.media="all"'><noscript><link href="https://fonts.googleapis.com/css2?family=Alata&family=Lora&family=Muli:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto&family=Muli:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel=stylesheet></noscript><link rel=stylesheet href=/css/font.css media=all><meta property="og:title" content="MVVMLight navigation and AppCompatActivity"><meta property="og:description" content="As much as I&rsquo;m loving MVVMLight it does have some limitations. The one I&rsquo;ve hit recently is how well it doesn&rsquo;t work when you are using AppCompat (though to be honest I think it&rsquo;s more down to how hacky AppCompat seems to be).
I&rsquo;m using AppCompatActivity as my base activity class to get an action bar supported on older API versions. The problem is MVVMLight implements it&rsquo;s own ActivityBase which is derived from Activity, and it relies on a set of static methods and properties on this to handle things like navigation and dialogs."><meta property="og:type" content="article"><meta property="og:url" content="https://jimbobbennett.dev/blogs/mvvmlight-navigation-and-appcompatactivity/"><meta property="og:image" content="https://jimbobbennett.dev/blogs/mvvmlight-navigation-and-appcompatactivity/banner.png"><meta property="article:section" content="blogs"><meta property="article:published_time" content="2016-02-08T00:16:50+00:00"><meta property="article:modified_time" content="2016-02-08T00:16:50+00:00"><meta property="og:site_name" content="JimBobBennett"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://jimbobbennett.dev/blogs/mvvmlight-navigation-and-appcompatactivity/banner.png"><meta name=twitter:title content="MVVMLight navigation and AppCompatActivity"><meta name=twitter:description content="As much as I&rsquo;m loving MVVMLight it does have some limitations. The one I&rsquo;ve hit recently is how well it doesn&rsquo;t work when you are using AppCompat (though to be honest I think it&rsquo;s more down to how hacky AppCompat seems to be).
I&rsquo;m using AppCompatActivity as my base activity class to get an action bar supported on older API versions. The problem is MVVMLight implements it&rsquo;s own ActivityBase which is derived from Activity, and it relies on a set of static methods and properties on this to handle things like navigation and dialogs."><meta name=twitter:site content="@jimbobbennett"><meta name=twitter:creator content="@jimbobbennett"><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css integrity=sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3 crossorigin=anonymous><link rel=stylesheet href=/css/header.css media=all><link rel=stylesheet href=/css/footer.css media=all><link rel=stylesheet href=/css/theme.css media=all><link rel="shortcut icon" type=image/png href=/fav.png><link rel="shortcut icon" sizes=192x192 href=/fav.png><link rel=apple-touch-icon href=/fav.png><link rel=alternate type=application/rss+xml href=https://jimbobbennett.dev/index.xml title=JimBobBennett><script type=text/javascript>(function(e,t,n,s,o,i,a){e[n]=e[n]||function(){(e[n].q=e[n].q||[]).push(arguments)},i=t.createElement(s),i.async=1,i.src="https://www.clarity.ms/tag/"+o,a=t.getElementsByTagName(s)[0],a.parentNode.insertBefore(i,a)})(window,document,"clarity","script","dctc2ydykv")</script><style>:root{--text-color:#343a40;--text-secondary-color:#6c757d;--background-color:#000;--secondary-background-color:#64ffda1a;--primary-color:#007bff;--secondary-color:#f8f9fa;--text-color-dark:#e4e6eb;--text-secondary-color-dark:#b0b3b8;--background-color-dark:#000000;--secondary-background-color-dark:#212529;--primary-color-dark:#ffffff;--secondary-color-dark:#212529}body{background-color:#000;font-size:1rem;font-weight:400;line-height:1.5;text-align:left}</style><meta name=description content><link rel=stylesheet href=/css/index.css><link rel=stylesheet href=/css/single.css><link rel=stylesheet href=/css/projects.css media=all><script defer src=/fontawesome-5/all-5.15.4.js></script><title>MVVMLight navigation and AppCompatActivity | JimBobBennett</title></head><body class=light onload=loading()><header><nav class="pt-3 navbar navbar-expand-lg"><div class="container-fluid mx-xs-2 mx-sm-5 mx-md-5 mx-lg-5"><a class="navbar-brand primary-font text-wrap" href=/><img src=/fav.png width=30 height=30 class="d-inline-block align-top">
JimBobBennett</a>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarContent aria-controls=navbarContent aria-expanded=false aria-label="Toggle navigation"><svg aria-hidden="true" height="24" viewBox="0 0 16 16" width="24" data-view-component="true"><path fill-rule="evenodd" d="M1 2.75A.75.75.0 011.75 2h12.5a.75.75.0 110 1.5H1.75A.75.75.0 011 2.75zm0 5A.75.75.0 011.75 7h12.5a.75.75.0 110 1.5H1.75A.75.75.0 011 7.75zM1.75 12a.75.75.0 100 1.5h12.5a.75.75.0 100-1.5H1.75z"/></svg></button><div class="collapse navbar-collapse text-wrap primary-font" id=navbarContent><ul class="navbar-nav ms-auto text-center"><li class="nav-item navbar-text"><a class=nav-link href=/ aria-label=home>Home</a></li><li class="nav-item navbar-text"><a class=nav-link href=/#about aria-label=about>About</a></li><li class="nav-item navbar-text"><a class=nav-link href=/#projects aria-label=projects>Recent Highlights</a></li><li class="nav-item navbar-text"><a class=nav-link href=/blogs title="Blog posts">Blog</a></li><li class="nav-item navbar-text"><a class=nav-link href=/videos title=Videos>Videos</a></li><li class="nav-item navbar-text"><a class=nav-link href=/livestreams title=Livestreams>Livestreams</a></li><li class="nav-item navbar-text"><a class=nav-link href=/conferences title=Conferences>Conferences</a></li><li class="nav-item navbar-text"><a class=nav-link href=/resume title=Resume>Resume</a></li></ul></div></div></nav></header><div id=content><section id=projects><div class="container pt-5" id=list-page><div class="row justify-content-center px-3 px-md-5"><h1 class="text-left pb-2 content">MVVMLight navigation and AppCompatActivity</h1><div class="text-left content">Jim Bennett
<small>|</small>
Feb 8, 2016</div></div></div></section><section id=single><div class=container><div class="row justify-content-center"><div class="col-sm-12 col-md-12 col-lg-9"><div class=pr-lg-4><article class="page-content p-2"><p>As much as I&rsquo;m loving <a href=http://mvvmlight.codeplex.com>MVVMLight</a> it does have some limitations. The one I&rsquo;ve hit recently is how well it doesn&rsquo;t work when you are using AppCompat (though to be honest I think it&rsquo;s more down to how hacky AppCompat seems to be).</p><p>I&rsquo;m using <a href=http://developer.android.com/reference/android/support/v7/app/AppCompatActivity.html>AppCompatActivity</a> as my base activity class to get an action bar supported on older API versions. The problem is MVVMLight implements it&rsquo;s own <code>ActivityBase</code> which is derived from <code>Activity</code>, and it relies on a set of static methods and properties on this to handle things like navigation and dialogs. If you want to use <code>AppCompatActivity</code> you are stuck - navigation will not work.</p><blockquote class=twitter-tweet data-lang=en><p lang=en dir=ltr>Seems to get <a href="https://twitter.com/hashtag/mvvmlight?src=hash">#mvvmlight</a> working with AppCompatActivity I have to write my own NavigationService. <a href=https://twitter.com/LBugnion>@LBugnion</a> any thoughts?</p>&mdash; Jim Bennett (@jimbobbennett) <a href=https://twitter.com/jimbobbennett/status/696149246022520833>February 7, 2016</a></blockquote><script async src=//platform.twitter.com/widgets.js></script><blockquote class=twitter-tweet data-conversation=none data-lang=en><p lang=en dir=ltr><a href=https://twitter.com/jimbobbennett>@jimbobbennett</a> I don't have a better proposal at this point. Android is severely broken when it comes to launching new activities.</p>&mdash; Laurent Bugnion (@LBugnion) <a href=https://twitter.com/LBugnion/status/696273172937760769>February 7, 2016</a></blockquote><script async src=//platform.twitter.com/widgets.js></script><p>Luckily MVVMLight is really well designed with good separation of concerns, so everything is done via interface. This means we can write our own implementation of the navigation service and dialog service that will work with <code>AppCompatActivity</code> and use it in our code. Being open source as well we can take the existing source and tweak it slightly to make it work for us. It&rsquo;s a bit of a hack but it works.</p><p>The first thing to do is to define our own base activity class that has the same functionality as the <code>ActivityBase</code>, but derived from <code>AppCompatActivity</code>.</p><pre tabindex=0><code>using Android.Support.V7.App;

namespace JimBobBennett.MvvmLight.AppCompat
{
    public abstract class AppCompatActivityBase : AppCompatActivity
    {
        public static AppCompatActivityBase CurrentActivity { get; private set; }

        internal string ActivityKey { get; private set; }

        internal static string NextPageKey { get; set; }
        
        public static void GoBack()
        {
            CurrentActivity?.OnBackPressed();
        }
        
        protected override void OnResume()
        {
            CurrentActivity = this;
            if (string.IsNullOrEmpty(ActivityKey))
            {
                ActivityKey = NextPageKey;
                NextPageKey = null;
            }
            base.OnResume();
        }
    }
}
</code></pre><p>This is identical to the MVVMLight <code>ActivityBase</code> except the base class is <code>AppCompatActivity</code>.</p><p>Now we have our base activity we can use it for the navigation service. This is identical to the MVVMLight Android <code>NavigationService</code> except instead of accessing the statics on <code>AppCompatActivityBase</code> instead of on <code>ActivityBase</code>.</p><pre tabindex=0><code>using System;
using System.Collections.Generic;
using Android.Content;
using GalaSoft.MvvmLight.Views;

namespace JimBobBennett.MvvmLight.AppCompat
{
    public class AppCompatNavigationService : INavigationService
    {
        private readonly Dictionary&lt;string, Type&gt; _pagesByKey = new Dictionary&lt;string, Type&gt;();
        private readonly Dictionary&lt;string, object&gt; _parametersByKey = new Dictionary&lt;string, object&gt;();

        private const string RootPageKey = &#34;-- ROOT --&#34;;
        private const string ParameterKeyName = &#34;ParameterKey&#34;;
        
        public string CurrentPageKey =&gt; AppCompatActivityBase.CurrentActivity.ActivityKey ?? RootPageKey;
        
        public void GoBack()
        {
            AppCompatActivityBase.GoBack();
        }
        
        public void NavigateTo(string pageKey)
        {
            NavigateTo(pageKey, null);
        }
        
        public void NavigateTo(string pageKey, object parameter)
        {
            AppCompatActivityBase.CurrentActivity.RunOnUiThread(() =&gt;
            {
                if (AppCompatActivityBase.CurrentActivity == null)
                    throw new InvalidOperationException(&#34;No CurrentActivity found&#34;);

                lock (_pagesByKey)
                {
                    if (!_pagesByKey.ContainsKey(pageKey))
                        throw new ArgumentException($&#34;No such page: {pageKey}. Did you forget to call NavigationService.Configure?&#34;, nameof(pageKey));

                    var intent = new Intent(AppCompatActivityBase.CurrentActivity, _pagesByKey[pageKey]);
                    if (parameter != null)
                    {
                        lock (_parametersByKey)
                        {
                            var guid = Guid.NewGuid().ToString();
                            _parametersByKey.Add(guid, parameter);
                            intent.PutExtra(ParameterKeyName, guid);
                        }
                    }

                    AppCompatActivityBase.CurrentActivity.StartActivity(intent);
                    AppCompatActivityBase.NextPageKey = pageKey;
                }
            });
        }

        public void Configure(string key, Type activityType)
        {
            lock (_pagesByKey)
            {
                if (_pagesByKey.ContainsKey(key))
                    _pagesByKey[key] = activityType;
                else
                    _pagesByKey.Add(key, activityType);
            }
        }

        public object GetAndRemoveParameter(Intent intent)
        {
            if (intent == null)
                throw new ArgumentNullException(nameof(intent), &#34;This method must be called with a valid Activity intent&#34;);

            var stringExtra = intent.GetStringExtra(ParameterKeyName);
            if (string.IsNullOrEmpty(stringExtra))
                return null;

            lock (_parametersByKey)
                return _parametersByKey.ContainsKey(stringExtra) ? _parametersByKey[stringExtra] : null;
        }
        
        public T GetAndRemoveParameter&lt;T&gt;(Intent intent)
        {
            return (T)GetAndRemoveParameter(intent);
        }
    }
}
</code></pre><p>We then do the same for the dialog service:</p><pre tabindex=0><code>using System;
using System.Threading.Tasks;
using Android.App;
using Android.Content;
using GalaSoft.MvvmLight.Views;

namespace JimBobBennett.MvvmLight.AppCompat
{
    public class AppCompatDialogService : IDialogService
    {
        public Task ShowError(string message, string title, string buttonText, Action afterHideCallback)
        {
            var afterHideCallbackWithResponse = (Action&lt;bool&gt;) (r =&gt;
            {
                if (afterHideCallback == null)
                    return;
                afterHideCallback();
                afterHideCallback = null;
            });

            var dialog = CreateDialog(message, title, buttonText, null, afterHideCallbackWithResponse);
            dialog.Dialog.Show();
            return dialog.Tcs.Task;
        }

        public Task ShowError(Exception error, string title, string buttonText, Action afterHideCallback)
        {
            var afterHideCallbackWithResponse = (Action&lt;bool&gt;)(r =&gt;
            {
                if (afterHideCallback == null)
                    return;
                afterHideCallback();
                afterHideCallback = null;
            });

            var dialog = CreateDialog(error.Message, title, buttonText, null, afterHideCallbackWithResponse);
            dialog.Dialog.Show();
            return dialog.Tcs.Task;
        }
        
        public Task ShowMessage(string message, string title)
        {
            var dialog = CreateDialog(message, title);
            dialog.Dialog.Show();
            return dialog.Tcs.Task;
        }
        
        public Task ShowMessage(string message, string title, string buttonText, Action afterHideCallback)
        {
            var afterHideCallbackWithResponse = (Action&lt;bool&gt;)(r =&gt;
            {
                if (afterHideCallback == null)
                    return;
                afterHideCallback();
                afterHideCallback = null;
            });

            var dialog = CreateDialog(message, title, buttonText, null, afterHideCallbackWithResponse);
            dialog.Dialog.Show();
            return dialog.Tcs.Task;
        }
        
        public Task&lt;bool&gt; ShowMessage(string message, string title, string buttonConfirmText, string buttonCancelText, Action&lt;bool&gt; afterHideCallback)
        {
            var afterHideCallbackWithResponse = (Action&lt;bool&gt;)(r =&gt;
            {
                if (afterHideCallback == null)
                    return;
                afterHideCallback(r);
                afterHideCallback = null;
            });

            var dialog = CreateDialog(message, title, buttonConfirmText, buttonCancelText ?? &#34;Cancel&#34;, afterHideCallbackWithResponse);
            dialog.Dialog.Show();
            return dialog.Tcs.Task;
        }
        
        public Task ShowMessageBox(string message, string title)
        {
            return ShowMessage(message, title);
        }

        private static AlertDialogInfo CreateDialog(string content, string title, string okText = null, string cancelText = null, Action&lt;bool&gt; afterHideCallbackWithResponse = null)
        {
            var tcs = new TaskCompletionSource&lt;bool&gt;();
            var builder = new AlertDialog.Builder(AppCompatActivityBase.CurrentActivity);
            builder.SetMessage(content);
            builder.SetTitle(title);
            var dialog = (AlertDialog)null;
            builder.SetPositiveButton(okText ?? &#34;OK&#34;, (d, index) =&gt;
            {
                tcs.TrySetResult(true);
                if (dialog != null)
                {
                    dialog.Dismiss();
                    dialog.Dispose();
                }
                if (afterHideCallbackWithResponse == null)
                    return;
                afterHideCallbackWithResponse(true);
            });

            if (cancelText != null)
            {
                builder.SetNegativeButton(cancelText, (d, index) =&gt;
                {
                    tcs.TrySetResult(false);
                    if (dialog != null)
                    {
                        dialog.Dismiss();
                        dialog.Dispose();
                    }
                    if (afterHideCallbackWithResponse == null)
                        return;
                    afterHideCallbackWithResponse(false);
                });
            }

            builder.SetOnDismissListener(new OnDismissListener(() =&gt;
            {
                tcs.TrySetResult(false);
                if (afterHideCallbackWithResponse == null)
                    return;
                afterHideCallbackWithResponse(false);
            }));

            dialog = builder.Create();

            return new AlertDialogInfo
            {
                Dialog = dialog,
                Tcs = tcs
            };
        }

        private struct AlertDialogInfo
        {
            public AlertDialog Dialog;
            public TaskCompletionSource&lt;bool&gt; Tcs;
        }

        private sealed class OnDismissListener : Java.Lang.Object, IDialogInterfaceOnDismissListener
        {
            private readonly Action _action;

            public OnDismissListener(Action action)
            {
                _action = action;
            }

            public void OnDismiss(IDialogInterface dialog)
            {
                _action();
            }
        }
    }
}
</code></pre><p>To use these all we need to do is derive all our activities from <code>AppCompatActivityBase</code> and register the <code>AppCompatNavigationService</code> and <code>AppCompatDialogService</code> in our IoC container as implementations of <code>INavigationService</code> and <code>IDialogService</code>.</p><p>The code for this is up on GitHub here: <a href=https://github.com/jimbobbennett/JimBobBennett.MvvmLight.AppCompat>https://github.com/jimbobbennett/JimBobBennett.MvvmLight.AppCompat</a></p><p>I&rsquo;ve also created a NuGet package available here: <a href=https://www.nuget.org/packages/JimBobBennett.MvvmLight.AppCompat/>https://www.nuget.org/packages/JimBobBennett.MvvmLight.AppCompat/</a> or searchable from the Package Manager as <code>JimBobBennett.MvvmLight.AppCompat</code>.</p><hr><h4 id=update>Update</h4><p>Thanks to <a href=http://sa.muel.be>Samuel Debruyn</a> for adding an update to this package.</p><p>MVVMLight has a helper class to aid in running code on the UI thread called <a href=http://www.mvvmlight.net/help/SL5/html/5af6dede-4a22-2eb2-d0fa-5af0f2fe4fe5.htm>DispatcherHelper</a>. This will verify the current activity and use that to run the specified action on the UI thread using the <code>RunOnUIThread</code> method.</p><p>Unfortunately for us this relies on the <code>CurrentActivity</code> property on <code>ActivityBase</code>, something we are not using. Sam has added an <code>AppCompatDispatcherHelper</code> which mimics the logic of the <code>DispatcherHelper</code> but using the <code>AppCompatActivityBase.CurrentActivity</code> instead.</p><p>The <a href=https://github.com/jimbobbennett/JimBobBennett.MvvmLight.AppCompat>code on GitHub</a> and <a href=https://www.nuget.org/packages/JimBobBennett.MvvmLight.AppCompat/>NuGet package</a> have both been updated with these changes.</p></article></div></div><div class="col-sm-12 col-md-12 col-lg-3"><div class=sticky-sidebar><aside class=toc><h5>Table Of Contents</h5><div class=toc-content><nav id=TableOfContents><ul><li><ul><li></li></ul></li></ul></nav></div></aside><aside class=tags><h5>Tags</h5><ul class="tags-ul list-unstyled list-inline"><li class=list-inline-item><a href=https://jimbobbennett.dev/tags/xamarin target=_blank>xamarin</a></li><li class=list-inline-item><a href=https://jimbobbennett.dev/tags/xamarin.android target=_blank>xamarin.android</a></li><li class=list-inline-item><a href=https://jimbobbennett.dev/tags/mvvmlight target=_blank>mvvmlight</a></li><li class=list-inline-item><a href=https://jimbobbennett.dev/tags/appcompat target=_blank>AppCompat</a></li><li class=list-inline-item><a href=https://jimbobbennett.dev/tags/nuget target=_blank>nuget</a></li><li class=list-inline-item><a href=https://jimbobbennett.dev/tags/technology target=_blank>Technology</a></li></ul></aside></div></div></div><div class=row><div class="col-sm-12 col-md-12 col-lg-9 p-4"><div id=disqus_thread></div><script>var disqus_config=function(){this.page.url="https://jimbobbennett.dev/blogs/mvvmlight-navigation-and-appcompatactivity/",this.page.identifier="ceab03bf7e07291fc13a78e2678c2eca"};(function(){if(window.location.hostname=="localhost")return;var e=document,t=e.createElement("script");t.src="https://jimbobbennett.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div></div></div><button class="p-2 px-3" onclick=topFunction() id=topScroll>
<i class="fas fa-angle-up"></i></button></section><script>var topScroll=document.getElementById("topScroll");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?topScroll.style.display="block":topScroll.style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}</script></div><footer><div class="container py-4"><div class="row justify-content-center"><div class="col-md-4 text-center">&copy; 2022 All Rights Reserved</div></div></div></div></footer><script src=https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js integrity=sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13 crossorigin=anonymous></script>
<script>document.body.className.includes("light")&&(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))</script><script>let loadingIcons;function loading(){myVar=setTimeout(showPage,100)}function showPage(){try{document.getElementById("loading-icons").style.display="block"}catch{}}</script><script>function createCopyButton(e,t){const n=document.createElement("button");n.className="copy-code-button",n.type="button",n.innerText="Copy",n.addEventListener("click",()=>copyCodeToClipboard(n,e,t)),addCopyButtonToDom(n,e)}async function copyCodeToClipboard(e,t,n){const s=t.querySelector("pre > code").innerText;try{n.writeText(s)}finally{codeWasCopied(e)}}function codeWasCopied(e){e.blur(),e.innerText="Copied!",setTimeout(function(){e.innerText="Copy"},2e3)}function addCopyButtonToDom(e,t){t.insertBefore(e,t.firstChild);const n=document.createElement("div");n.className="highlight-wrapper",t.parentNode.insertBefore(n,t),n.appendChild(t)}if(navigator&&navigator.clipboard)document.querySelectorAll(".highlight").forEach(e=>createCopyButton(e,navigator.clipboard));else{var script=document.createElement("script");script.src="https://cdnjs.cloudflare.com/ajax/libs/clipboard-polyfill/2.7.0/clipboard-polyfill.promise.js",script.integrity="sha256-waClS2re9NUbXRsryKoof+F9qc1gjjIhc2eT7ZbIv94=",script.crossOrigin="anonymous",script.onload=function(){addCopyButtons(clipboard)},document.querySelectorAll(".highlight").forEach(e=>createCopyButton(e,script)),document.body.appendChild(script)}</script></body></html>